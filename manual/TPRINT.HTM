<!--
$Id: TPRINT.HTM,v 1.7 2016-05-22 23:52:47 fyurisich Exp $
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
<title>TPRINT</title>


<style>
html {
	overflow-y:scroll;
}

body {
	padding: 0px;
	margin: 0px;
	overflow: auto;
	background-color: #FFFFFF;
}

#winchm_template_navigation{
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 0px;
	margin-right: 0px;

	padding-top: 5px;
	padding-left: 5px;
	padding-bottom: 5px;
	padding-right: 5px;

	font-family: arial, helvetica, sans-serif;
	font-size: 10px;
	font-style: normal;
	font-weight: normal;
	color: #626262;

	border-bottom-style: solid;
	border-bottom-width: 1px;
	border-bottom-color: #DBDBDB;

	background-color: #E2EDFA;
	width: auto;
}

#winchm_template_button{
	float: right;
	top: -7px;
	position: relative;
	text-align: right;
	right: -5px;
	height: auto;
}

#winchm_template_title{
	font-family: Segoe UI, Tahoma, Geneva, Verdana, sans-serif;
	font-weight: bold;
	font-size: 18px;
	color: 353535;

	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 0px;
	margin-right: 0px;

	padding-top: 10px;
	padding-left: 5px;
	padding-bottom: 10px;
	padding-right: 10px;

	border-bottom-style: solid;
	border-bottom-width: 1px;
	border-bottom-color: #C7C7C7;

	width: auto;
	background-color: #C4DBF4;
	text-align: left;
}

#winchm_template_content{
	padding: 0px;
	margin-top: 15px;
	margin-left: 15px;
	margin-bottom: 15px;
	margin-right: 15px;

	width: auto  !important;
	width: 100%;
}

#winchm_template_footer{
	border-width: 1px;
	border-color: #c0c0c0;
	border-top-style: solid;

	margin-top: 0px;
	margin-left: 15px;
	margin-bottom: 5px;
	margin-right: 15px;

	padding-top: 6px;
	padding-left: 0px;
	padding-bottom: 20px;
	padding-right: 0px;

	font-family: arial, helvetica, sans-serif;
	font-size: 9px;
	color: #909090;

	text-align: left;
	width: auto;
}

#winchm_template_navigation a:link	{text-decoration: none;color: #0000ff}
#winchm_template_navigation a:visited  {text-decoration: none; color: #0000ff}
#winchm_template_navigation a:active {text-decoration: none; color: #0000ff}
#winchm_template_navigation a:hover {text-decoration: none;color: #0000ff}

a:link	{text-decoration: underline; color:#0033cc}
a:visited  {text-decoration: underline; color: #0033cc}
a:active {text-decoration: underline; color: #0033cc }
a:hover {text-decoration: underline;color: #ff0000;}

@media print
{
#winchm_template_button{
visibility:hidden;
}
}
</style>
</head>

<body>

<div id="winchm_template_title">
<div id="winchm_template_button"><A href="CLASSES.HTM" title="Previous topic"><img id="winchm_template_prev" alt="Previous topic" src="template4/btn_prev_n.gif" border="0"></a><A href="LIBRARIES.HTM" title="Next topic"><img id="winchm_template_next" alt="Next topic" src="template4/btn_next_n.gif" border="0"></a></div>
TPRINT CLASS</div>
<div id="winchm_template_navigation">Help &gt;
Classes &gt; </div>
<div id="winchm_template_content">

<div class=Section1>

<PRE>
<span style='color:darkgreen'><b>
///////////////////////////////////////////////////////////////////////////////
// TPRINT Class
///////////////////////////////////////////////////////////////////////////////
</b></span>

This class is a wrapper for different modes of printing a report or
exporting it to a file.

<p><u>How to use it</u>:

The general procedure to use this class is:

  1. Instantiate an object.
  2. Initialize object variables and allocate resources.
  3. Select a printer (if you want to print the document.)
  4. Signal the start of the document.
  5. Repeat for each page:
     Signal the start of the page.
     Print data, barcodes, images, lines and rectangles.
     Signal the end of the page.
  6. Signal the end of the document.
  7. Release allocated resources.

  Notes:
    All this steps are required to obtain the intended output
    and avoid errors and memory leaks.
    See .\samples\oohg\printtest.prg for a functional sample.
    Use &quot;compile MainDemoOop&quot; to build and test it.

<p><u>How to instantiate an object</u>:

<b>oTPrintObject := TPRINT( cMode )</b>

  Returns an object that allows you to build a document and to print
  or export it to a file.

  Valid values for cMode are:
    HBPRINTER          = Prints using HBPrinter library.
    MINIPRINT          = Prints using Miniprint library.
    DOSPRINT           = Prints directly to printer (DOS printing).
    CALCPRINT          = Generates an OpenOffice Calc file
                         (OpenOffice must be installed installed).
    EXCELPRINT         = Generates an Excel file
                         (Excel must be installed).
    RTFPRINT           = Generates an RTF file.
    HTMLPRINT          = Generates an HTML file using Excel if installed
                         or Calc if it's not.
    HTMLPRINTFROMCALC  = Generates an HTML file using Calc.
    HTMLPRINTFROMEXCEL = Generates an HTML file using Excel.
    PDFPRINT           = Generates a PDF file.
    CSVPRINT           = Generates a comma-separated values file (CSV).
    RAWPRINT           = Prints directly to a spool queue (in binary).
    SPREADSHEETPRINT   = Generates an Excel file using BIFF format
                         (neither Excel nor OpenOffice are need).

  Notes:
    If cMode is omitted, the selected library depends on public variable
    _OOHG_PrintLibrary.
    If the variable is not a string, MINIPRINT will be selected.
    If its a string but its value is not one of the expected values,
    HBPRINTER will be selected.
    If cMode is present but is not one of the expected string values,
    MINIPRINT will be selected.
    Once the TRINT object is created, _OOHG_PrintLibrary is set to the
    selected mode.

<p><u>Main methods</u>:

<b>::Init()</b>

  Initializes object variables and allocates resources.

  Notes:
    This method sets the DATA lPrError .T. if another document is
    being printed.

<b>::SelPrinter( lSelect, lPreview, lLandscape, nPaperSize, cPrinter, ;
              lHide, nRes, nBin, nDuplex, lCollate, nCopies, lColor, ;
              nScale, nPaperLength, nPaperWidth )</b>

  For HBPRINTER, MINIPRINT, DOSPRINT and RAWPRINT modes, selects
  and initializes the printer. For RTFPRINT, sets the page orientation.
  For TPDFPRINT, sets the page size and orientation. Does nothing for
  other modes.

  Parameters:
    lSelect      = .T. to select the printer from a dialog (default),
                   .F. to print in the system's default printer
                   It's ignored if cPrinter is not NIL.
    lPreview     = .T. to show a preview before printing (default),
                   .F. to print directly.
    lLandscape   = .T. to print in landscape orientation,
                   .F. to print in portrait orientation (default).
    nPaperSize   = sets the paper size (defaults to printer's value).
                   See &quot;miniprint.ch&quot; and &quot;winprint.ch&quot; for valid values.
                   Check &quot;wingdi.h&quot; to see if a given paper size is
                   supported by a given Windows version.
    cPrinter     = name of an existing printer to use for printing
                   (if omitted and lSelect is .T. a selection dialog will
                   pop up, if it's .F. the default printer will be used).
    lHide        = .F. to show a &quot;wait&quot; window while printing (default),
                   .T. to show none.
    nRes         = resolution (defaults to printer's value).
                   See &quot;miniprint.ch&quot; and &quot;winprint.ch&quot; for valid values.
    nBin         = tray number from which the paper will be taken
                   (defaults to printer's value).
                   See &quot;miniprint.ch&quot; and &quot;winprint.ch&quot; for valid values.
    nDuplex      = duplex type (defaults to printer's value).
                   See &quot;miniprint.ch&quot; and &quot;winprint.ch&quot; for valid values.
    lCollate     = .T. to enable collate printing if printer supports it,
                   .F. to disable (defaults to printer's value).
    nCopies      = number of copies that the printer will print if it
                   supports automatic multiple copies printing (defaults
                   to printer's value).
    lColor       = for color printers, sets monochrome or color mode
                   (defaults to printer's value).
    nScale       = Specifies the factor by which the printed output is to
                   be scaled (defaults to printer's value).
    nPaperLength = Overrides the length of the paper specified by the
                   nPaperSize parameter (defaults to printer's value).
                   Unit: 1/10 mm.
    nPaperWidth  = Overrides the width of the paper specified by the
                   nPaperSize parameter (defaults to printer's value).
                   Unit: 1/10 mm.

  Parameter support by printing mode:
    MINIPRINT and HBPRINTER:
      All.
    DOSPRINT:
      Only lSelect, lPreview, cPrinter and lHide are suppported.
    RAWPRINT:
      Only lSelect, cPrinter and lHide are suppported.
    RTFPRINT:
      Only lPreview, lLandscape and lHide are supported.
    PDFPRINT:
      Only lPreview, lLandscape, nPaperSize and lHide are supported.
    EXCELPRINT, SPREADSHEETPRINT, HTMLPRINT, HTMLPRINTFROMEXCEL,
    HTMLPRINTFROMCALC, CSVPRINT and CALCPRINT:
      Only lPreview and lHide are supported.

<b>::BeginDoc( cName )</b>

  Signals the start of a document.

  Parameters:
    cName = name of the print document (defaults to &quot;list&quot;).
            If the library generates a file, any provided extension
            will be stripped and a default extension will be added.
            Provide a path to save in a specific folder (defaults
            to My Documents).

  Notes:
    Default extensions are:
      "dos" for DOSPRINT.
      "raw" for RAWPRINT.
      "rtf" for RTFPRINT.
      "pdf" for PDFPRINT.
      "xls" for EXCELPRINT using Excel version previous to 2007.
      "xlsx" for EXCELPRINT using Excel version 2007 or later.
      "xls" for SPREADSHEETPRINT.
      "html" for HTMLPRINT, HTMLPRINTFROMEXCEL and HTMLPRINTFROMCALC.
      "csv" for CSVPRINT.
      "odt" for CALCPRINT.

<b>::BeginPage( cName )</b>

  Signals the start of a page inside a document.

  Parameters:
    cName = name of the page. Must be unique.
            Defaults to &quot;Page_&quot; + page_number.
            For EXCELPRINT and CALCPRINT: the page name is used as
            caption for the sheet.

<b>::EndPage()</b>

  Signals the end of a page inside a document.

<b>::EndDoc( lSaveTemp )</b>

  Signals the end of a document.

  Parameters:
    lSaveTemp = .T. to save temporary files, .F. to discard.

  Notes:
    For HBPRINTER, MINIPRINT, DOSPRINT and RAWPRINT modes: if lPreview
    parameter of method SelPrinter was .T., a preview screen with the
    document's content is shown.
    For EXCELPRINT, CALCPRINT, SPREADSHEETPRINT, HTMLPRINT, HTMLPRINTCALC,
    HTMLPRINTEXCEL, RTFPRINT, CSVPRINT and PDFPRINT modes: opens the
    document using the systems' default application.

  Parameter support by printing mode:
    lSaveTemp is only supported by DOSPRINT and RAWPRINT modes.

<b>::Release()</b>

  Releases the TPRINT object and all allocated resources.

<p><u>Data print methods</u>:

<b>::PrintData( nLin, nCol, uData, cFont, nSize, lBold, aColor, ;
             cAlign, nLen, lItalic, nAngle, lUnder, lStrike, nWidth )</b>

  Prints data in a page.

  Parameters:
    nLin    = y coordinate of starting point (ROWCOL or MM).
              Defaults to 1.
    nCol    = x coordinate of starting point (ROWCOL or MM).
              Defaults to 1.
    uData   = data to print (see note), defaults to &quot;&quot;.
    cFont   = name of the default font for printing. Defaults to value
              of DATA cFontName. See MSDN for CreateFont function to
              learn more about fonts.
    nSize   = size of the font in points. Defaults to value of DATA
              nFontSize.
    lBold   = .T. for printing with bold weight, .F. for printing with
              normal weight. Defauls to value of DATA lFontBold.
    aColor  = text color of printed data ({nRed, nGreen, nBlue}).
              Defaults to value of DATA aFontColor.
    cAlign  = text alignment:
                 L - left (default)
                 C - center
                 R - right
    nLen    = width (in chars) of the field where the data will be
              printed, this value is used to right or center align
              the data in a part of the line. Defaults to 15.
    lItalic = .T. for printing with italic style, .F. for printing
              without. Defauls to value of DATA lFontItalic.
    nAngle  = the rotation of a character. Unit: 1/10 degree.
              Defaults to 0.
    lUnder  = .T. for printing with underlined style, .F. for printing
              without. Defauls to value of DATA lFontUnderline.
    lStrike = .T. for printing with strikedoud style, .F. for printing
              without. Defauls to value of DATA lFontStrikeout.
    nWidth  = the average width of characters. Unit: logical units.
              Defaults to system's default value.

  Notes:
    Codeblocks are evaluated and the resulting values are treated
    according the following rules.
    Strings and memos are printed as they are.
    Numbers are converted to strings using AllTrim( Str( uData ) ).
    Dates are converted to strings usings DtoC( uData ).
    Logicals are converted to &quot;T&quot; or &quot;F&quot;.
    Timestaps are converted to strings using TtoC( uData ).
    Objects are printed as &quot;&lt; Object &gt;&quot;.
    Arrays are printed as &quot;&lt; Array &gt;&quot;.
    Other data type values are printed as empty strings.
     
  Parameter support by printing mode:
    MINIPRINT:
      All.
    THBPRINTER:
      All.
    DOSPRINT:
      Only nLin, nCol, uData, lBold, cAlign and nLen.
    RAWPRINT:
      Only nLin, nCol, uData, lBold, cAlign and nLen.
    EXCELPRINT:
      nWidth is not supported.
    SPREADSHEETPRINT:
      Only nLin, nCol, uData, cAlign and nLen.
    RTFPRINT:
      cFont, aColor, nAngle and nWidth are not supported.
      This mode uses &quot;Times New Roman&quot; as default font when
      printing in MM and &quot;Courier New&quot; when printing in ROWCOL.
      You can embed whatever format you want in uData, as long as it's
      written using proper RTF syntax. Notice that the content of a
      RichEditBox control can be printed this way.
    CSVPRINT:
      Only nLin, nCol, uData, cAlign and nLen.
    PDFPRINT:
      nAngle, lUnder, lStrike and nWidth are not supported.
      cFont accepts &quot;Helvetica&quot;, &quot;Times&quot; and &quot;Courier&quot;. Other fonts are
      mapped to them: roman types to &quot;Times&quot;, &quot;Ariel&quot; to &quot;Helvetica&quot; and
      the remaining ones to &quot;Courier&quot;.
    CALCPRINT:
      nWidth is not supported.
    HTMLPRINT:
      nWidth is not supported.
    HTMLPRINTFROMCALC:
      nWidth is not supported.
    HTMLPRINTFROMEXCEL:
      nWidth is not supported.

<b>::PrintImage( nSRow, nSCol, nERow, nECol, cImage, aResol, aSize )</b>

  Prints an image.

  Parameters:
    nSRow  = y coordinate of the upper left corner.
             Defaults to 1.
    nSCol  = x coordinate of the upper left corner.
             Defaults to 1.
    nERow  = y coordinate of the lower right corner.
             Defaults to 4.
    nECol  = x coordinate of the lower right corner.
             Defaults to 4.
    cImage = name of the image to print. Must point to a file.
             MINIPRINT and HBPRINTER also accept images from the resource
             file. See note. Defaults to &quot;&lt;&gt;&quot;.
    aResol = array specifing horizontal and vertical resolution of the
             image (or a number if both values are the same). Unit: DPI.
    aSize  = array specifing width and height of the image (or a number
             if both values are the same). Unit: 1/100 mm.

  Notes:
    MINIPRINT and HBPRINTER support ICO, BMP, JPG and GIF formats.
    EXCELPRINT and HTMLPRINTFROMEXCEL support formats supported by Excel.
    CALCPRINT and HTMLPRINTFROMCALC support formats supported by Calc.
    PDFPRINT supports JPG and GIF formats. Beware that cImage must point
    to a file with TIF, TIFF, JPG or JPEG extension.
    DOSPRINT, RAWPRINT, SPREADSHEETPRINT, RTFPRINT and CSVPRINT do not
    support image printing.
    When using HTMLPRINT, supported formats depend on the underlying app
    installed on the system (if both Excel and Calc are installed, the
    first takes precedence; you can test DATA cPrintLibrary to identify
    which one is being used).

  Parameter support by printing mode:
    aResol and aSize are supported by CALCPRINT mode only.
    Specify aResol to print the image at its original size. To find the
    image resolution use a graphics software like IrfanView.
    Specify aSize to print the image at a different size.
    If both parameters are specified, resolution takes precedence.
    If none is specified the resulting size is defined by Calc.

<b>::PrintLine( nSRow, nSCol, nERow, nECol, aColor, nWidth, lSolid )</b>

  Prints a line from one point to another.

  Parameters:
    nSRow  = y coordinate of the starting point.
             Defaults to 1.
    nSCol  = x coordinate of the starting point.
             Defaults to 1.
    nERow  = y coordinate of the ending point.
             Defaults to 4.
    nECol  = x coordinate of the ending point.
             Defaults to 4.
    aColor = line's color ({nRed, nGreen, nBlue}).
             Defaults to value of DATA aColor.
    nWidth = line's width (see note).
             Defaults to value of DATA nwPen.
    lSolid = .F. for dashed line, .T. for continuous (default).

  Notes:
    DOSPRINT, RAWPRINT and RTFPRINT modes only support the printing of
    horizontal lines (nSRow == nERow). Lines are printed using dashes.
    PDFPRINT mode only supports the printing of horizontal (nSRow == nERow)
    or vertical (nSCol == nECol) lines.
    MINIPRINT and HBPRINTER can print horizontal, vertical and oblique lines.
    Other modes don't support line printing.
    nWidth units: mm for MINIPRINT and HBPRINTER, 1/72 inches for PDFPRINT.
    If nWidth is greater than 1, lSolid is ignored and assumed .T.

  Parameter support by printing mode:
    MINIPRINT and HBPRINTER:
      All.
    PDFPRINT:        
      lSolid not suported (assumed .T.).
    DOSPRINT and RAWPRINT:
      aColor, nWidth and lSolid not supported.
    RTFPRINT:
      nWidth and lSolid not supported.

<b>::PrintRectangle( nSRow, nSCol, nERow, nECol, aColorOut, nWidth, lSolid, aColorFil )</b>

  Prints a rectangle defined by 4 lines between points:
    {nSRow, nSCol} to {nSRow, nECol},
    {nSRow, nECol} to {nERow, nECol},
    {nERow, nECol} to {nERow, nSCol} and
    {nERow, nSCol} to {nSRow, nSCol}.

  Parameters:
    nSRow     = y coordinate of the upper left corner.
                Defaults to 1.
    nSCol     = x coordinate of the upper left corner.
                Defaults to 1.
    nERow     = y coordinate of the lower right corner.
                Defaults to 4.
    nECol     = x coordinate of the lower right corner.
                Defaults to 4.
    aColorOut = outline color ({nRed, nGreen, nBlue}).
                Defaults to value of DATA aColor.
    nWidth    = border's width (see note).
                Defaults to value of DATA nwPen.
    lSolid    = .F. for dashed line, .T. for continuous (default).
    aColorFil = filling color ({nRed, nGreen, nBlue}).
                Defaults to WHITE.

  Notes:
    Only PDFPRINT, MINIPRINT and HBPRINTER support rectangle printing.
    nWidth units: mm for MINIPRINT and HBPRINTER, 1/72 inches for PDFPRINT.
    If nWidth is greater than 1, lSolid is ignored and assumed .T.

  Parameter support by printing mode:
    MINIPRINT and HBPRINTER:
      All.
    PDFPRINT:
      lSolid not suported (assumed .T.).

<b>::PrintRoundRectangle( nSRow, nSCol, nERow, nECol, aColorOut, nWidth, lSolid, aColorFil )</b>

  Prints a rectangle with rounded corners, defined by 4 lines between
  points:
    {nSRow, nSCol} to {nSRow, nECol},
    {nSRow, nECol} to {nERow, nECol},
    {nERow, nECol} to {nERow, nSCol} and
    {nERow, nSCol} to {nSRow, nSCol}.

  Parameters:
    nSRow     = y coordinate of the upper left corner.
                Defaults to 1.
    nSCol     = x coordinate of the upper left corner.
                Defaults to 1.
    nERow     = y coordinate of the lower right corner.
                Defaults to 4.
    nECol     = x coordinate of the lower right corner.
                Defaults to 4.
    aColorOut = outline color ({nRed, nGreen, nBlue}).
                Defaults to value of DATA aColor.
    nWidth    = border's width (see note).
                Defaults to value of DATA nwPen.
    lSolid    = .F. for dashed line, .T. for continuous (default).
    aColorFil = filling color ({nRed, nGreen, nBlue}).
                Defaults to WHITE.

  Notes:
    Only MINIPRINT and HBPRINTER support round rectangle printing.
    PDFPRINT prints them with squared corners.
    nWidth units: mm for MINIPRINT and HBPRINTER, 1/72 inches for PDFPRINT.
    If nWidth is greater than 1, lSolid is ignored and assumed .T.

  Parameter support by printing mode:
    MINIPRINT and HBPRINTER:
      All.
    PDFPRINT:
      lSolid not suported (assumed .T.).

<b>::PrintBarCode( nRow, nCol, cCode, cType, aColor, lHorizontal, nWidth, nHeight )</b>

  Generates and prints a barcode of a certain type.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
                  Defaults to &quot;&lt;&gt;&quot;.
    cType       = encoding type of the barcode. Supported types are
                  CODE128A, CODE128B, CODE128C, CODE39, EAN8, EAN13,
                  INTER25, UPCA, SUP5, CODABAR, IND25 and MAT25.
                  Defaults to CODE128C.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
                  Defaults to value of DATA aBarColor.
    lHorizontal = .F. for vertical printing, .T. for horizontal (default).
    nWidth      = width of each bar. Unit: mm.
                  Defaults to NIL.
    nHeight     = height of each bar. Unit: mm.
                  Defaults to 10.

  Notes:
    This method is a wrapper for methods ::Code128, ::Code3_9, ::Codabar,
    ::Ean8, ::Ean13, ::Ind25, ::Int25, ::Mat25, ::Sup5 and ::Upca.

<b>::Code128( nRow, nCol, cCode, cVariant, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints a CODE128A, CODE128B or CODE128C encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    cVariant    = code variant to print. Supported types are &quot;A&quot;, &quot;B&quot;, &quot;C&quot;
                  or &quot;&quot; (variable mode: cCode is analized to identify type).
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm.
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on function _Code128() to generate the barcode
    and on method ::Go_Code to print it.

<b>::Code3_9( nRow, nCol, cCode, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints a CODE39 encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm.
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on function _Code3_9() to generate the barcode
    and on method ::Go_Code to print it.

<b>::Codabar( nRow, nCol, cCode, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints a CODABAR encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm.
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on function _Codabar() to generate the barcode
    and on method ::Go_Code to print it.

<b>::Ean8( nRow, nCol, cCode, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints an EAN-8 encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm. Defaults to 1.5
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on functions _Upc() and _Ean13bl() to generate
    the barcode and on method ::Go_Code to print it.

<b>::Ean13( nRow, nCol, cCode, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints an EAN-13 encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm. Defaults to 1.5
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on functions _Ean13() and _Ean13bl() to generate
    the barcode and on method ::Go_Code to print it.

<b>::Ind25( nRow, nCol, cCode, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints a CODE 25 INDUSTRIAL encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm.
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on functions _Ind25() to generate the barcode
    and on method ::Go_Code to print it.

<b>::Int25( nRow, nCol, cCode, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints a CODE 25 INTERLEAVED encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm.
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on functions _Int25() to generate the barcode
    and on method ::Go_Code to print it.

<b>::Upca( nRow, nCol, cCode, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints an UPC-A encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm. Defaults to 1.5
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on functions _Upc() and _Upcabl() to generate
    the barcode and on method ::Go_Code to print it.

<b>::Mat25( nRow, nCol, cCode, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints a MATRIX 2 OF 5 encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm.
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on functions _Mat25() to generate the barcode
    and on method ::Go_Code to print it.

<b>::Sup5( nRow, nCol, cCode, aColor, lHorizontal, nWidth, nHeigth )</b>

  Generates and prints an EAN-5 encoded barcode.

  Parameters:
    nRow        = y coordinate of the starting point.
                  Defaults to 1.
    nCol        = x coordinate of the starting point.
                  Defaults to 1.
    cCode       = value to be converted into a barcode.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
    lHorizontal = .F. for vertical printing, .T. for horizontal.
    nWidth      = width of each bar. Unit: mm.
    nHeight     = height of each bar. Unit: mm.

  Notes:
    This method relies on functions _Sup5() to generate the barcode
    and on method ::Go_Code to print it.

<b>::Go_Code( cBarcode, nRow, nCol, lHorizontal, aColor, nWidth, nHeigth )</b>

  Prints a barcode.

  Parameters:
    cBarCode    = barcode to print.
    nRow        = y coordinate of the starting point.
                  Defaults to 0.
    nCol        = x coordinate of the starting point.
                  Defaults to 0.
    aColor      = bars' color ({nRed, nGreen, nBlue}).
                  Defaults to BLACK.
    lHorizontal = .F. for vertical printing, .T. for horizontal (default).
    nWidth      = width of each bar. Unit: mm. Defaults to 0.495.
    nHeight     = height of each bar. Unit: mm. Defaults to 15.

<p><u>Other methods</u>:

<b>::CondenDos()</b>

  Sets the printer to condensed mode.

  Notes:
    Applies only to DOSPRINT mode.

<b>::GetDefPrinter()</b>

  Gets the name of the default printer.

  Notes:
    Applies only to MINIPRINT and HBPRINTER modes.

<b>::NormalDos()</b>

  Sets the printer to normal mode.

  Notes:
    Applies only to DOSPRINT mode.

<b>::PrintMode()</b>

  Prints the content of the file pointed by DATA cTempFile.

  Notes:
    Applies only to DOSPRINT and RAWPRINT modes.
    For DOSPRINT is equivalent to ::PrintDos( ::cTempFile ).
    For RAWPRINT is equivalent to ::PrintRaw( ::cTempFile ).

<b>::PrintDos( cFile )</b>

  Prints the content of a file, by copying it to the printer port
  specified by DATA cPort, using DOS Copy command.

  Parameters:
    cFile = name of the file to print.

<b>::PrintRaw( cFile )</b>

  Prints the content of the file pointed by DATA TempFile, by
  copying it to the printer specified by DATA cPrinter, using
  Windows WritePrinter function.

<b>::SetBarColor( aColor )</b>

  Sets the default color for barcodes.

  Parameters:
    aColor = color ({nRed, nGreen, nBlue}).
             Defaults to almost BLACK ({1, 1, 1}).

  Notes:
    This method sets the DATA aBarColor.

<b>::SetColor( aColor )</b>

  Sets the default color for text, lines and rectangles.

  Parameters:
    aColor = color ({nRed, nGreen, nBlue}).
             Defaults to BLACK.

  Notes:
    This method sets the DATA aColor.

<b>::SetCPL( nCpl )</b>

  Sets the maximum number of printed characters per line.

  Parameters:
    nCpl = 60, 80, 96, 120, 140 or 160. Defaults to 80 for all modes
           except for RTFPRINT which defaults to 96.

  Notes:
    The desired number of CPL is achieved by the setting of the default
    size of the font (DATA nFontSize) to 14, 12, 10, 8, 7 and 6 points
    respectively.

<b>::SetDosPort( cPort )</b>

  Sets the DOS port to use for printing.

  Parameters:
    cPort = PRN, LPT1: to LPT6: and system's local ports.

  Notes:
    Applies only to DOSPRINT mode.

<b>::SetFont( cFont, nSize, aColor, lBold, lItalic, nAngle, lUnder, lStrike, nWidth )</b>

  Sets the attributes of the default font.

  Parameters:
    cFont   = name of a font installed in the system.
              Defaults to value of DATA cFontName.
    nSize   = size in points.
              Defaults to value of DATA nFontSize.
    aColor  = color ({nRed, nGreen, nBlue}).
              Defaults to value of DATA aFontColor.
    lBold   = .T. for bold type, .F. for non bold type.
              Defaults to value of DATA lFontBold.
    lItalic = .T. for italic type, .F. for non-italic type.
              Defaults to value of DATA lFontItalic.
    nAngle  = the rotation of the characters. Unit: 1/10 degree.
              Defaults to value of DATA nFontAngle.
    lUnder  = .T. for underline type, .F. for non underline type.
              Defaults to value of DATA lFontUnderline.
    lStrike = .T. for strikeout type, .F. for non strikeout type.
              Defaults to value of DATA lFontStrikeout.
    nWidth  = average width of characters, in logical units.
              Defaults to value of DATA nFontWidth.

  Notes:
    Search MSDN for CreateFont function to learn more about fonts.

<b>::SetFontType( nFontType )</b>

  Sets the default weight of the letter for a page.

  Parameters:
    nFontType = 0 for normal weight, 1 for bold.

  Notes:
    Applies only to PDFPRINT mode.

<b>::SetIndentation( lIndentation )</b>

  Sets the indentation mode when printing the RichValue of a RichEditBox.
  Parameters:
    lIndentation = when .T. and the RichValue contains more than one
                   line, all lines are placed at the column specified
                   in the PrintData call. When .F., subsequent lines
                   are placed at column 0.

  Notes:
    Applies only to TRTFPRINT mode.

<b>::SetLMargin( nLMar )</b>

  Sets the left margin for printed lines.

  Parameters:
    nLMar = number of columns or millimiters. Defaults to 0.

<b>::SetPreviewSize( nSize )</b>

  Sets the preview initial size (zoom) for HBPRINTER and MINIPRINT modes.

  Parameters:
    nSize = For HBPRINTER mode: 1 to 5 (small to big).
                                Defaults to 3.
            For MINIPRINT mode: -9.99 to 99.99 (small to big).
                                Defaults to 0.
   
<b>::SetProp( lMode )</b>

  Sets whether the row height will be proportional to the size of the
  default font (DATA nFontSize) or to 10 points.

  Parameters:
    lMode = .T. for nFontSize, .F. for 10 points (default).

<b>::SetRawPrinter( cPrinter )</b>

  Sets the printer queue to use when printing through the spooler.

  Parameters:
    cPrinter = name of a printer managed by the system's spool.

  Notes:
    Applies only to RAWPRINT mode.

<b>::SetSeparateSheet( lSeparateSheets )</b>

  Sets the use of a different sheet for each page in the document.

  Notes:
    Applies only to EXCELPRINT and CALCPRINT.

<b>::SetShowErrors( lShow )</b>

  Enables or disables the display of messages when an error occurs.

<b>::SetTMargin( nTMar )</b>

  Sets the top margin for printed pages.

  Parameters:
    nTMar = number of rows or millimiters. Defaults to 0.

<b>::SetUnits( cUnits, nUnitsLin )</b>

  Sets the units that will be used for printing.

  Parameters:
    cUnits = MM for milimiters or ROWCOL for rows and columns (default).

  Notes:
    The class uses internally MM to try to obtain documents that look
    in the same way when printed on different printers.

<b>::Version()</b>

  Gets the version number of the TPRINT library.

<p><u>Datas</u>:

   All the datas are READONLY.

                                 <u>Initial value</u>              <u>Notes</u>

   <b>::aBarColor</b>         {1, 1, 1}                            brush color for barcodes
   <b>::aColor</b>            {0, 0, 0}                            brush color
   <b>::aFontColor</b>        {0, 0, 0}                            font color
   <b>::aPageNames</b>        {}                                   page's names
   <b>::aPorts</b>            {}                                   available printing ports
   <b>::aPrinters</b>         {}                                   available printers
   <b>::Cargo</b>             "list"                               document's name without extension
   <b>::cDocument</b>         ""                                   document's name with extension
   <b>::cFontName</b>         "Courier New"                        font name
   <b>::cPageName</b>         ""                                   current page name
   <b>::cPort</b>             "PRN"                                currently selected port
   <b>::cPrinter</b>          ""                                   currently selected printer
   <b>::cPrintLibrar</b>y     "HBPRINTER"                          currently selected printer mode
   <b>::cTempFile</b>         TEMP_FILE_NAME
   <b>::cUnits</b>            "ROWCOL"                             currently selected printing units
   <b>::cVersion</b>          "(oohg-tprint)V 4.10"                library's current version
   <b>::ImPreview</b>         .T.
   <b>::lFontBold</b>         .F.
   <b>::lFontItalic</b>       .F.
   <b>::lFontStrikeout</b>    .F.
   <b>::lFontUnderline</b>    .F.
   <b>::lIndentAll</b>        .F.                                  Indent RicheEdit lines
   <b>::lLandscape</b>        .F.                                  Page orientation
   <b>::lPrError</b>          .F.
   <b>::lProp</b>             .F.
   <b>::lSaveTemp</b>         .F.
   <b>::lSeparateSheets</b>   .T.
   <b>::lShowErrors</b>       .T.
   <b>::lWinHide</b>          .F.
   <b>::nFontAngle</b>        0
   <b>::nFontSize</b>         12
   <b>::nFontType</b>         1
   <b>::nFontWidth</b>        0
   <b>::nhFij</b>             ( 12 / 3.70 )
   <b>::nLinPag</b>           0
   <b>::nLMargin</b>          0
   <b>::nmHor</b>             ( 10 / 4.75 )
   <b>::nmVer</b>             ( 10 / 2.35 )
   <b>::nTMargin</b>          0
   <b>::nUnitsLin</b>         1
   <b>::nvFij</b>             ( 12 / 1.65 )
   <b>::nwPen</b>             0.1                                  pen width in MM, do not exceed 1

</PRE>
</span>

</div>
<div id="winchm_template_footer"><FONT color=#808080
size=1>Copyright © 2013-2016 ooHG Development Team - </FONT><A
href="https://sourceforge.net/projects/oohg/" target="_blank"><FONT
size=1>https://sourceforge.net/projects/oohg/</FONT></A>
     </div>

</body>
</html>
